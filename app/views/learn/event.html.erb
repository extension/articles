<% @page_title = @learn_session.title %>

<%= render(:partial => "partial/flashmessages") %>

<div id="two_col_col_one">
   <section id="event">
   <h1>
   <%= @learn_session.title %>
   </h1>

   <p class="description"><%= format_text_for_display(@learn_session.description) %></p>

   <h3>Presented by</h3>
   <p id="presenters">
      <% count = 0 %>
         <% @learn_session.presenters.each do |presenter| %>
         <% if count > 0 %>, 
         <% end %>
         <%= link_to(presenter.fullname, :controller => '/learn', :action => :profile, :id => presenter.login) %>
         <% count = count + 1 %>
      <% end %>  
     </p>
      
      <h4>Tags</h4>
      <p id="tags">
      <% if @learn_session.tags.length != 0 %>  
      <%= @learn_session.tags.collect{|t| link_to t.name, :action => :events, :sessiontype => "by_tag", :tag => t.name}.join(Tag::JOINER) %>
      <% else %>
      There are no tags at this time
      <% end %>
      </p>
      
      
        <% if @learn_session.event_concluded? %>
          <% if @learn_session.recording.blank? %>
            <p class="no_recording_available">
            There are currently no recordings posted yet.
            </p>
          <% else %>
          <h3>Watch</h3>
            <p class="recording_available">
               <%= link_to(@learn_session.recording, @learn_session.recording) %>
            </p>
          <% end %>
        <% else %>
          <p>View and Participate: <%= link_to(@learn_session.location, @learn_session.location) %></p>
          <p>Watch: (This session has not taken place yet. The recording should be available here after the session has taken place.)</p>
        <% end %>
        
        <% if @currentuser %>
          <p><span class="edit"><%= link_to 'edit this event', :action => :edit_session, :id => @learn_session.id %></span></p>
        <% end %>
   </section>
</div>

<section id="two_col_col_two">
   <aside id="event_time" class="radius10">
      
      <% if @learn_session.event_concluded? %>
      
         <% if @learn_session.recording.blank? %>
            <h3>No Recording Yet</h3>
            <p>This <strong><%= "#{@learn_session.session_length}" %> minute</strong> session took place <strong><%= @session_start.strftime("%l:%M %p, %B %e, %Y %Z") %></strong>. A recording of this session has not been uploaded yet.</p>
          <% else %>
          <h3>Watch</h3>
            <p>This <strong><%= "#{@learn_session.session_length}" %> minute</strong> session took place <strong><%= @session_start.strftime("%l:%M %p, %B %e, %Y %Z") %></strong></p>
            <p class="recording_available">
               <%= link_to("watch recording", @learn_session.recording) %>
            </p>
          <% end %>
      
      <% else %>

        <h2>
           <span id="session_date"><%= @session_start.strftime("%B %e, %Y") %></span>
           <div class="calendarblock">
              <span class="month"><%= @session_start.strftime("%b") %></span>
              <span class="date"><%= @session_start.strftime("%d") %></span>
           </div>
           <span id="session_date_time">
              <span id="time"><%= @session_start.strftime("%l:%M %p").downcase %> <span id="timezone"><%= @session_start.strftime("%Z") %></span></span>
           </span>
        </h2>
        <p><%- if @currentuser -%>
          <%- if(!@currentuser.has_time_zone?) -%>
           <%= link_to("Set your time zone", :controller =>  'people/profile', :action => :edit) %>  to display this session in your local time
          <%- end -%>
        <%- else -%>
          <%= link_to("Login to set your time zone", :controller => :learn, :action => :time_zone_check, :id => @learn_session.id) %> to display this session in your local time
        <%- end -%></p>   
      
        <p id="session_duration"><strong><%= "#{@learn_session.session_length}" %> minute</strong> session</p>
                        
      <% end %>
   </aside>
   
   <%- if @currentuser -%>
      <%- if @learn_session.event_started? -%>
        <aside id="sessionconnection_interest" class="radius10">
          <%= render(:partial => 'auth_session_interest') %>
        </aside>

        <aside id="sessionconnection_attendance" class="radius10">
          <%= render(:partial => 'auth_session_attendance') %>
        </aside>
      <%- else -%>
        <aside id="sessionconnection_interest" class="radius10">
          <%= render(:partial => 'auth_session_interest') %>
        </aside>
      <%- end -%>
   <%- else -%>
     <aside id="sessionconnection_interest" class="radius10">
        <%- if @learn_session.event_started? -%>
          Are you interested in this topic or did you attend this session? 
        <%- else -%>
          Interested in this topic?
        <%- end -%>
        <%= link_to("Login and let us know", :controller => :learn, :action => :connect_to_session, :id => @learn_session.id) %>
     </aside>
   <%- end -%>

   <%- if @currentuser -%>
   <aside id="attendees" class="radius10">   
     <%= render(:partial => 'connected_users') %>
   </aside>
   <%- end -%>
   
   
   
   
</section>
