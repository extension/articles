<h1 class="title">Ask an Expert</h1>

<h2 id="aae_submit_step">Please fill in the additional information and submit your question<span></span></h2>

<% form_for :submitted_question, @submitted_question, :url => { :action => :submission_form }, :html => { :id => 'searchbox_002594610894210374936:hggphannnzi', :class => 'aae', :multipart => true } do |f| %>
  <fieldset>
    <h3>
    <%= f.label :asked_question, 'Your Question' %>
    <a class="tooltip_trigger local aae_help" href="#aae_question_tooltip" rel="#aae_question_tooltip">
    What kinds of questions can eXtension answer?
    </a>
    </h3>
    
    <p>
      <%= f.text_area :asked_question, {:rows => "3"} %>
    </p>
  </fieldset>
  
  <h3>Images <span class="optional">(optional)</span></h3>
  <p><em>Include up to <%= FileAttachment::MAX_AAE_UPLOADS %> images. You can upload .jpg .png or .gif. Max size of 2MB each.</em></p>
  
  <fieldset>
  <% (1..FileAttachment::MAX_AAE_UPLOADS).each do |image_counter| %>
    <% fields_for "file_attachment#{image_counter}" do |file_attachment| %> 
    <p class="image_upload"><%= file_attachment.file_field :attachment %></p>
    <% end %>
  <% end %>
  </fieldset>

  <h3>Category <span class="optional">(optional)</span></h3>
  
  <p class="instructions">Tip: Questions can be answered more quickly when assigned to the correct community</p>
  
  <fieldset class="stack_labels">
  	<p>
  	<%= select_tag("aae_category", options_for_select(@categories, @submitted_question.top_level_category ? @submitted_question.top_level_category.id : '')) %>
  	</p>
  	<%= observe_field("aae_category", :update => :subcat_div, :url => { :action => :get_aae_form_subcats }, :with => "'category_id=' + value") %>

    <p id="subcat_div">
      <% if @sub_category_options %>
        <%= render(:partial => 'aae_subcats')%>
      <% end %>
    </p>
  </fieldset>

  <h3>Your location</h3>
  
  <p class="instructions">Where should the question be directed?</p>
  <fieldset class="stack_labels">
    <p>
        <label>Location
        <%= select_tag 'location_id', options_for_select(get_location_options, default_location_id(@submitted_question ? @submitted_question.location_id : nil)) %>
        </label>
    </p>

    	<%= observe_field('location_id',
    	                  :update    => :county_list,
    	                  :url       => { :controller => 'aae/search', :action => :get_counties, :show_label => 'yes'},
    	                  :with      => "'location_id='+value") %>

    <p id="county_list">
      <% if @submitted_question.location and @submitted_question.location.counties.length > 0 %>
      	<label>County
      	<%= select_tag 'county_id', options_for_select(get_county_options(@submitted_question.location), default_county_id(@submitted_question ? @submitted_question.county_id : nil)) %>
          </label>
      <% end %>
    </p>
  </fieldset>
  
  <h3>Personal Information</h3>

  <p><em>Fields marked with an asterisk (<span style="color:red;">*</span>) are required</em></p>
  
  <% fields_for :submitter, @submitter do |submitter| %>
  <fieldset>
      <p class="simplefield">
          <%= submitter.label :first_name, 'First Name:' %>
          <%= submitter.text_field :first_name %>
      </p>

  	  <br class="clearing" />
      
      <p class="simplefield">
          <%= submitter.label :last_name, 'Last Name:' %>
          <%= submitter.text_field :last_name %>
      </p>
      
      <br class="clearing" />
      
      <p class="simplefield">
          <%= submitter.label :email, 'Email:<em class="required">*</em>' %>
          <%= submitter.text_field :email, { :type => "email", :autocapitalize => "off" } %>
      </p>
      
      <br class="clearing" />
          
      <p class="simplefield">
          <label for="submitter_email_confirmation">Email Confirmation:<em class="required">*</em></label>
          <%= text_field_tag "submitter_email_confirmation", @submitter_email_confirmation.nil? ? @submitter.email : @submitter_email_confirmation, :type => "email",  :autocapitalize => "off" %>
      </p>
  </fieldset>
  
  <% end %>

  <p><%= submit_tag "Submit my Question", :name => "sa", :value => "Submit my Question", :alt => "Go", :class => "bigbutton blue" %></p>
   
  <input type="hidden" name="cx" value="002594610894210374936:hggphannnzi" />
  <input type="hidden" name="cof" value="FORID:11" />
  
  <!-- end of form -->    
<% end %>


<%= javascript_include_tag "google_coop" %>
<!-- Google CSE Search Box Ends -->

<div id="aae_question_tooltip" class="tooltip" >
    <h3>What kinds of questions can eXtension answer?</h3>
    <p>We have expertise in a broad variety of areas. You can see a list of our content areas by clicking the "Resource Areas" link at the top of this page.</p>
</div>

<script type="text/javascript">
  $j = jQuery.noConflict();
  $j(document).ready(function() {
    $j('a.title').cluetip({splitTitle: '|'});
    $j('a.tooltip_trigger.local').cluetip({local:true, cursor: 'pointer',width: 300, showTitle:false});
    
    $j(".fancybox").fancybox({
			'titleShow'		: false
		});
  })
</script>