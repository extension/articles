<div id="widget_builder">
    <h2>Customize Your Content Widget</h2>
     
    <% form_tag({}, {:id => 'content_widget_builder'}) do %>
    
    <p><label>Type of Content:</label></p>
    <ul>
    <li><%= radio_button_tag(:type, 'articles', false) %> Articles</li>
    <li><%= radio_button_tag(:type, 'faqs', false) %> FAQs</li>
    <li><%= radio_button_tag(:type, 'events', false) %> Events</li>
    <li><%= radio_button_tag(:type, 'faqs_articles', true) %> Articles and FAQs</li>
    </ul>
    
    <p class="inline"><label>Number of latest items: <%= text_field_tag :quantity, @default_quantity, :size => 3 %></label></p>
    
    <p class="inline"><label>Width: <%= text_field_tag :width, @default_width, :size => 3 %> pixels</label></p>
   
      <p>
        <label>Content Tags:</label>
      <%= text_area_tag :tags, nil, :cols => "50", :rows => "2" %>
      <span class="gray">Comma separated (i.e. horses, horticulture). Leave blank for all content.</span>
      </p>
      
      <ul id="tag_operator">
         <li><%= radio_button_tag(:tag_operator, 'or', true) %> Display content with <strong>any</strong> of the above tags </li>
         <li><%= radio_button_tag(:tag_operator, 'and', false) %> Display content with <strong>all</strong> of the above tags</li>
      </ul>
      
      <p>Content Tag Picker (click to add)</p>
      <div id="tag_wrapper">
      <ul class="select_from_tags">
      <% @launched_categories.each do |category| %>
          <li><%= link_to_function category.name, "addTagsToList($('tags'), '#{category.name}'), showOperatorOptions()" %></li>
      <% end %>
      </ul>
      </div>
      
    <% end %>
    
    <%= button_to_remote 'Generate Widget', :url => { :action => :generate_new_widget },
        :update => 'example_widget',
        :submit => 'content_widget_builder',
        :loading => "Element.show('loading')",
        :complete    => "Element.hide('loading')"  %>
                
</div>

<div id="example_widget">
  <div id="loading" style="display:none"><p><img src='/images/widgets/ajax_loader_white.gif' /> Loading... </p></div>
  <script type="text/javascript" src="<%= url_for :controller => 'widgets/content', :action => :show, :escape => false, :quantity => @default_quantity, :width => @default_width, :type => 'articles_faqs' %>"></script>
  
  <div id="widget_code_module">
    <p>Copy the code below and paste it on your website:</p>
    <p><%= text_area_tag :widget_code, @widget_code, :rows => "5" %></p>
  </div>
  
</div>

<br class="clearing" />

<script type='text/javascript'>
  
  if ($('tags').value.include(',')) {
    $('tag_operator').setStyle({
      display: 'block'
    });
  }
  
  Event.observe('tags', 'keyup', function() {
    showOperatorOptions();
  });
  
  function showOperatorOptions() {
  	if ($('tags').value.include(',')) {
      $('tag_operator').setStyle({
        display: 'block'
      })
    } else {
      $('tag_operator').hide();
    }
  }
  
</script>