<%= render(:partial => 'aae_widget_nav') %>

<div id="article">

<div class="detailpage">

<p><%= link_to "All widgets", :controller => 'widgets/aae', :action => 'list' %> > Widget info</p>

<h2><%= @widget.name %></h2>

<p>Administrator: <strong><%= link_to_user(@widget.user) %></strong></p>

<p>Date Created: <strong><%= @widget.created_at %></strong></p>



<% if @widget_assignees.length > 0 %>
    <h4>Assignee Pool</h4>
    <p><strong class="groupicon"><%= @widget_assignees.size %> users</strong> are signed up to answer questions from this widget. <%= link_to "View assignee pool", :controller => 'widgets/aae', :action => 'widget_assignees', :id => @widget.id %></p>
<% else %>
    <div class="askalert">
        <p><strong>There are currently no users signed up to receive questions from this widget.</strong></p>
        <p>If you like, you can <%= link_to ("sign up to receive questions", :controller => 'aae/prefs', :action => 'widget_preferences') %> from this widget and begin answering.</p>
    </div>
<% end %>


<h4>Widget Status</h4>
<div class="active-status">
    <p>This widget is currently <strong id="widget_active"><%= @widget.active? ? "Active" : "Inactive" %></strong></p>
    <p id="<%= @widget.name %>">
        <%= check_box_tag "widget_#{@widget.id}", @widget.id, @widget.active?, :class => "inline" %>
        <%= label_tag "widget_#{@widget.id}", 'Active', :class => "inline" %>
        <span id="loading_widget_<%= @widget.id %>" class="float-spinner" style="display:none"><img src='/images/loading.gif' /> Saving... </span>
    </p>
    <p>When a widget is inactive, questions can not be submitted from it. The widget code should be removed from any web page.</p>
</div>

<%= observe_field("widget_#{@widget.id}",
                      :url       => { :controller => 'widgets/aae', :action => :toggle_activation },
                      :with      => "'widget_id=#{@widget.id}'",
                      :loading => "Element.show('loading_widget_#{@widget.id}')",
                      :complete    => "Element.hide('loading_widget_#{@widget.id}')") %>


<h4>Widget iFrame Code</h4>
<div id="widgetcode"><textarea><%= h(@widget_iframe_code) %></textarea></div>

<div id="history">
<%= render(:partial => 'widget_history') %>
</div>

</div>

</div>