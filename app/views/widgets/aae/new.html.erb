<% @selected_tab = :get %>

<%= render(:partial => 'aae_widget_nav') %>

<div id="article">

<%= error_messages_for 'widget' %>

<h2>Create your Ask an Expert Widget</h2>
<% form_tag({:controller => 'widgets/aae', :action => 'generate_widget_code'}) do %>
   <fieldset>
      <p>Select the location that you want your widget to cover. This will allow questions to be routed to experts who select the corresponding location in their Ask an Expert preferences.</p>
      
      <p>
         <label>Name your widget <span>(in order to track and find questions entered through it)</span>
         <%= text_field(:widget, :name) %>
         </label>
      </p>
    
      <p>
          <label>Location
          <%= select_tag 'location_id', options_for_select(get_location_options, @widget.location_id) %>
          </label>
      </p>

      	<%= observe_field('location_id',
      	                  :update    => :county_list,
      	                  :url       => { :controller => 'aae/search', :action => :get_counties },
      	                  :with      => "'location_id='+value") %>

      <p id="county_list">
        <%- if @widget.location and @widget.location.counties.length > 0 -%>
        	<label>
        	<%= select_tag 'county_id', options_for_select(get_county_options, @widget.county_id) %>
            </label>
        <%- end -%>
      </p>
    
      <p>
         <label>
         <%= check_box(:widget,:upload_capable, {:class => "checkbox" ,:checked => true}) %> Enable photo upload for your widget
         </label>
      </p>
      
      <p>
         <label>
         <%= check_box(:widget, :show_location, {:class => "checkbox"}) %> Show location fields on your widget <br/>
         <em>Note: if enabled, any provided location will override the default location for this widget.</em>
         </label>
      </p>
                
      <p><%= submit_tag "Get the Widget Code!", :disable_with => "Submitting..." %></p>
    </fieldset>
<% end %>

</div>