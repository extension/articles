<% @page_title = "User Report" %>

<div id="report">
    
<p id="activity_report"><%= link_to "All Reports",  :controller => 'reports' %> &gt; <%= @page_title %></p>

<h1><%= @user.fullname %> <small>(FAQ and Ask an Expert activity)</small></h1>

<h2 id="additional">Additional information available on this user's 
<%= link_to ("People profile", {:controller => 'people/colleagues', :action => 'showuser', :userid => @user.login}) %>
 or <%= link_to ("Ask an Expert profile", aae_profile_url(:id => @user.login)) %></h2>


 
<h3>User Details</h3>
<dl class="report">
    <dt>Title</dt>
    <dd><%= @user.title.nil? ? ' ' : @user.title %></dd>
    <dt>Email</dt>
    <dd><%= @user.email %></dd>
    <dt>Location</dt>
    <dd><%= @user.location.blank? ? ' ' : @user.location.name %></dd>
    <dt>County</dt>
    <dd><%= @user.county.blank? ? ' ' : @user.county.name %></dd>
    <dt>Institution</dt>
    <dd><%= @user.primary_institution_name(' ') %></dd>
</dl>

<br class="clear"/>
<h3>User Contributions</h3>
<%= render(:partial => 'date_selection')%>

<dl class="report">
	
   	<dt>Questions Currently Assigned (Ask an Expert)</dt>
	    <dd><%= link_to "#{@ucurrently_assigned} ",:action => "display_questions", :user => @user.id, :descriptor => "Currently Assigned as an Expert" , :num => @ucurrently_uassigned %></dd>

   <dt>Questions Ever Assigned (Ask an Expert)</dt>
    <dd><%= link_to "#{@uassigned} total",:action => "display_questions", :user => @user.id, :descriptor => "Assigned as an Expert" , :datefrom => @dateinterval[0], :dateto => @dateinterval[1], :num => @uassigned %></dd>
    <dt>Questions Resolved (Ask an Expert)</dt>
        <dd><%= link_to "#{@uresolved} total", :action => "display_questions", :user => @user.id, :descriptor => "Answered as an Expert" , :datefrom => @dateinterval[0], :dateto => @dateinterval[1], :num => @uresolved %></dd>
     
</dl>	
<br class="clear"/>
<h3>Response Times in Hours</h3><p>Calculated from assigned to resolved, for those questions that were assigned to this user.</p>
  <table cellspacing="0"  summary="user_response_stats">
      <tr>
	<th scope="col"> </th>
	<th scope="col">Average</th>
	<th scope="col">Standard Deviation </th>
	<th scope="col">N</th>
	</tr>
	 <tr>
		<td>Overall Resolved</td>
		<td><%=(@avgstdresults[0][0] && @avgstdresults[0][0] != 0) ? ("%.2f"  % @avgstdresults[0][0]) : 0 %></td>
		<td><%=( @avgstdresults[0][1] && @avgstdresults[0][1] != 0) ? ("%.2f" % @avgstdresults[0][1]) : 0%></td>
		<td><%= @avgstdresults[0][2] %></td>
	  </tr>
	  <tr>
		<td>Answered</td>
		<td><%= (@avgstdresults[1][0] && @avgstdresults[1][0] != 0) ? ("%.2f" % @avgstdresults[1][0]) : 0 %></td>
		<td><%= (@avgstdresults[1][1] && @avgstdresults[1][1] != 0) ? ("%.2f" % @avgstdresults[1][1]) : 0 %></td>
		<td><%= @avgstdresults[1][2]%></td>
	  </tr>
	    <tr>
	  	<td>Rejected</td>
	        <td><%= (@avgstdresults[2][0]  && @avgstdresults[2][0] != 0) ? ("%.2f" % @avgstdresults[2][0]) : 0 %></td>
			<td><%= (@avgstdresults[2][1] && @avgstdresults[2][1] != 0) ? ("%.2f" % @avgstdresults[2][1]) : 0 %></td>
			<td><%= @avgstdresults[2][2] %></td>
	    </tr>
	   	<tr>
			<td>Answered that eXtension does not have this Expertise</td>
			<td><%= (@avgstdresults[3][0] && @avgstdresults[3][0] != 0) ? ("%.2f" % @avgstdresults[3][0]) : 0 %></td>
			<td><%= (@avgstdresults[3][1] && @avgstdresults[3][1] != 0) ? ("%.2f" % @avgstdresults[3][1]) : 0 %></td>
			<td><%= @avgstdresults[3][2] %></td>
	    </tr>
		
  </table>

	
</div>